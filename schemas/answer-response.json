{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "AnswerResponse",
  "description": "Response from GET /answer/:id endpoint",
  "type": "object",
  "properties": {
    "runId": {
      "type": "string",
      "format": "uuid",
      "description": "ID of the run"
    },
    "status": {
      "type": "string",
      "enum": ["created", "running", "completed", "failed"],
      "description": "Current status"
    },
    "question": {
      "type": "string",
      "description": "The original question"
    },
    "answer": {
      "type": ["string", "null"],
      "description": "The generated answer (null if not completed)"
    },
    "obligations": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/Obligation"
      },
      "description": "Extracted obligations"
    },
    "laws": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/LawDoc"
      },
      "description": "Law documents considered"
    },
    "metrics": {
      "type": "object",
      "properties": {
        "totalMs": {
          "type": ["number", "null"],
          "description": "Total execution time"
        },
        "tools": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/ToolMetric"
          }
        }
      },
      "required": ["totalMs", "tools"]
    }
  },
  "required": ["runId", "status", "question", "answer", "obligations", "laws", "metrics"],
  "definitions": {
    "Obligation": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string"
        },
        "lawId": {
          "type": "string"
        },
        "title": {
          "type": "string"
        },
        "summary": {
          "type": "string"
        }
      },
      "required": ["id", "lawId", "title", "summary"]
    },
    "LawDoc": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "url": {
          "type": "string",
          "format": "uri"
        }
      },
      "required": ["id", "name", "url"]
    },
    "ToolMetric": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "calls": {
          "type": "number"
        },
        "totalMs": {
          "type": "number"
        }
      },
      "required": ["name", "calls", "totalMs"]
    }
  }
}
