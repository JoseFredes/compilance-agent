{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "RunResponse",
  "description": "Response from GET /run/:id endpoint",
  "type": "object",
  "properties": {
    "id": {
      "type": "string",
      "format": "uuid",
      "description": "Unique identifier for the run"
    },
    "question": {
      "type": "string",
      "description": "The original question"
    },
    "status": {
      "type": "string",
      "enum": ["created", "running", "completed", "failed"],
      "description": "Current status of the run"
    },
    "createdAt": {
      "type": "string",
      "format": "date-time",
      "description": "ISO timestamp when run was created"
    },
    "updatedAt": {
      "type": "string",
      "format": "date-time",
      "description": "ISO timestamp when run was last updated"
    },
    "startedAt": {
      "type": "string",
      "format": "date-time",
      "description": "ISO timestamp when agent started processing"
    },
    "completedAt": {
      "type": "string",
      "format": "date-time",
      "description": "ISO timestamp when processing completed"
    },
    "error": {
      "type": "string",
      "description": "Error message if status is 'failed'"
    },
    "logs": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Array of log messages from agent execution"
    },
    "selectedLawIds": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "IDs of laws selected by the agent"
    },
    "selectedLaws": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Names of laws selected by the agent"
    },
    "draftAnswer": {
      "type": "string",
      "description": "The generated answer"
    },
    "obligations": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/Obligation"
      },
      "description": "Extracted obligations from relevant laws"
    },
    "tools": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/ToolMetric"
      },
      "description": "Metrics for tools used during execution"
    },
    "totalMs": {
      "type": "number",
      "description": "Total execution time in milliseconds"
    }
  },
  "required": ["id", "question", "status", "createdAt", "updatedAt", "logs"],
  "definitions": {
    "Obligation": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the obligation"
        },
        "lawId": {
          "type": "string",
          "description": "ID of the law this obligation comes from"
        },
        "title": {
          "type": "string",
          "description": "Title of the obligation"
        },
        "summary": {
          "type": "string",
          "description": "Summary of the obligation"
        }
      },
      "required": ["id", "lawId", "title", "summary"]
    },
    "ToolMetric": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "Name of the tool"
        },
        "calls": {
          "type": "number",
          "description": "Number of times the tool was called"
        },
        "totalMs": {
          "type": "number",
          "description": "Total time spent in this tool (milliseconds)"
        }
      },
      "required": ["name", "calls", "totalMs"]
    }
  }
}
